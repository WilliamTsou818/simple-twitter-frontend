(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f8ad5faa"],{"1dd0":function(e,t,s){},"4c92":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container container--user"},[s("Head",{attrs:{title:e.title}}),s("section",{staticClass:"section-post"},[s("div",{staticClass:"section-post__avatar",style:{backgroundImage:"url("+e.currentUser.avatar+")"}}),s("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.description,expression:"description",modifiers:{trim:!0}}],staticClass:"section-post__description",attrs:{id:"section-post__description",name:"description",rows:"2",placeholder:"有什麼新鮮事？",required:""},domProps:{value:e.description},on:{input:function(t){t.target.composing||(e.description=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),s("span",{staticClass:"section-post__tip"},[e._v(e._s(e.postTip))]),s("button",{staticClass:"section-post__btn-tweet",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.handleNewPost.apply(null,arguments)}}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isProcessing,expression:"!isProcessing"}]},[e._v("推文")]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isProcessing,expression:"isProcessing"}],staticClass:"section-post__btn-tweet__spinner"})])]),s("div",{staticClass:"divider"}),s("section",{ref:"sectionTweets",staticClass:"section-tweets"},[e.isLoading?s("Spinner"):e._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading&&0===e.tweets.length,expression:"!isLoading && tweets.length === 0"}],staticClass:"section-tweets__tip"},[e._v(" 目前沒有推文 ")]),e._l(e.tweets,(function(t){return s("UserTweet",{key:t.TweetId,attrs:{"init-tweet":t},on:{"action-reply":e.handleActionReply}})}))],2)],1)},n=[],a=s("1da1"),r=s("5530"),o=(s("a4d3"),s("e01a"),s("96cf"),s("4cce")),c=s("2708"),d=s("2f62"),p=s("2375"),l=s("7a0f"),u=s("2e00"),h={components:{Head:l["a"],Spinner:p["a"],UserTweet:u["a"]},data:function(){return{title:"首頁",isLoading:!0,isProcessing:!1,tweets:[],description:"",descriptionMaxLength:140,postTip:""}},computed:Object(r["a"])({},Object(d["b"])(["currentUser"])),mixins:[c["d"],c["e"],c["a"]],created:function(){this.fetchTweets()},methods:{fetchTweets:function(){var e=arguments,t=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var i,n,a,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=!(e.length>0&&void 0!==e[0])||e[0],s.prev=1,t.isLoading=!0,s.next=5,o["a"].tweets.get();case 5:n=s.sent,a=n.data,t.tweets=a,i&&t.$refs.sectionTweets&&(t.$refs.sectionTweets.scrollTop=0),t.isLoading=!1,s.next=17;break;case 12:s.prev=12,s.t0=s["catch"](1),r="",s.t0.response?(console.log(s.t0.response.data),r=s.t0.response.data.message):(console.log(s.t0),r=s.t0.message),t.ToastError({title:"獲取推文失敗！",description:r});case 17:case"end":return s.stop()}}),s,null,[[1,12]])})))()},validation:function(){return this.description&&0!==this.description.length||(this.postTip="內容不可空白"),!(this.postTip.length>0)||(this.ToastError({title:"請填寫正確推文內容"}),!1)},handleNewPost:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var s,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.validation()){t.next=3;break}return t.abrupt("return");case 3:return e.isProcessing=!0,t.next=6,o["a"].tweets.newPost({description:e.description});case 6:if(s=t.sent,i=s.data,"success"===i.status){t.next=10;break}throw new Error(i.message);case 10:e.description="",e.isProcessing=!1,e.ToastSuccess({title:"推文成功！",description:i.message}),e.fetchTweets(),t.next=22;break;case 16:t.prev=16,t.t0=t["catch"](0),e.isProcessing=!1,n="",t.t0.response?(console.log(t.t0.response.data),n=t.t0.response.data.message):(console.log(t.t0),n=t.t0.message),e.ToastError({title:"推文失敗！",description:n});case 22:case"end":return t.stop()}}),t,null,[[0,16]])})))()}},watch:{description:function(){this.description.length>this.descriptionMaxLength?this.postTip="字數不可超過 ".concat(this.descriptionMaxLength," 字"):this.postTip=""},isNewPostRefresh:function(e){e&&(this.$store.dispatch("isNewPostRefresh",!1),this.fetchTweets())},isReplyRefresh:function(e){e&&(this.$store.dispatch("isReplyRefresh",!1),this.fetchTweets(!1))}}},w=h,f=(s("add9"),s("2877")),v=Object(f["a"])(w,i,n,!1,null,"73eeed70",null);t["default"]=v.exports},"56ec":function(e,t,s){},"7a0f":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"head"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.backArrow,expression:"backArrow"}],staticClass:"head__back",on:{click:e.handleBack}},[i("img",{staticClass:"head__back__icon",attrs:{src:s("ddf8"),alt:"back"}})]),i("div",{staticClass:"head__info"},[i("div",{staticClass:"head__info__title"},[e._v(e._s(e.title))]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.count,expression:"count"}],staticClass:"head__info__count"},[e._v(e._s(e.count)+" 推文")])])])},n=[],a=(s("a9e3"),{name:"Head",props:{backArrow:{type:Boolean,default:!1},title:{type:String,default:"loading",required:!0},count:{type:[String,Number],default:""}},methods:{handleBack:function(){this.$router.back()}}}),r=a,o=(s("cb7e"),s("2877")),c=Object(o["a"])(r,i,n,!1,null,"880320bc",null);t["a"]=c.exports},add9:function(e,t,s){"use strict";s("56ec")},cb7e:function(e,t,s){"use strict";s("1dd0")},ddf8:function(e,t,s){e.exports=s.p+"img/back.eb89e502.svg"}}]);
//# sourceMappingURL=chunk-f8ad5faa.c4a19864.js.map