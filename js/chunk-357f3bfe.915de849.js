(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-357f3bfe"],{"0e30":function(e,t,s){},"33eb":function(e,t,s){"use strict";s("0e30")},9787:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("form",{staticClass:"form",on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.handleSubmit.apply(null,arguments)}}},[s("div",{staticClass:"form__account"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.account,expression:"account"}],staticClass:"form__account__input",attrs:{id:"account",name:"account",type:"text",pattern:"[a-zA-Z0-9_]+",required:""},domProps:{value:e.account},on:{input:function(t){t.target.composing||(e.account=t.target.value)}}}),s("div",{class:["form__account__border",{error:e.accountTip.length>0}]}),s("label",{staticClass:"form__account__label",attrs:{for:"form__account__input"}},[e._v(" 帳號 ")]),s("span",{staticClass:"form__account__tip"},[e._v(e._s(e.accountTip))]),s("span",{class:["form__account__length",{error:e.accountLength>e.accountMaxLength}]},[e._v(" "+e._s(e.accountLength)+" / "+e._s(e.accountMaxLength)+" ")])]),s("div",{staticClass:"form__name"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"form__name__input",attrs:{id:"name",name:"name",type:"text",required:""},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),s("div",{class:["form__name__border",{error:e.nameTip.length>0}]}),s("label",{staticClass:"form__name__label",attrs:{for:"form__name__input"}},[e._v(" 名稱 ")]),s("span",{staticClass:"form__name__tip"},[e._v(e._s(e.nameTip))]),s("span",{class:["form__name__length",{error:e.nameLength>e.nameMaxLength}]},[e._v(" "+e._s(e.nameLength)+" / "+e._s(e.nameMaxLength)+" ")])]),s("div",{staticClass:"form__email"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"form__email__input",attrs:{id:"email",name:"email",type:"email",required:""},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),s("div",{class:["form__email__border",{error:e.emailTip.length>0}]}),s("label",{staticClass:"form__email__label",attrs:{for:"form__email__input"}},[e._v(" Email ")]),s("span",{staticClass:"form__email__tip"},[e._v(e._s(e.emailTip))])]),s("div",{staticClass:"form__password"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form__password__input",attrs:{id:"password",name:"password",type:"password",required:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),s("div",{class:["form__password__border",{error:e.passwordTip.length>0}]}),s("label",{staticClass:"form__password__label",attrs:{for:"form__password__input"}},[e._v(" 密碼 ")]),s("span",{staticClass:"form__password__tip"},[e._v(e._s(e.passwordTip))]),s("span",{class:["form__password__length",{error:e.passwordLength>e.passwordMaxLength}]},[e._v(" "+e._s(e.passwordLength)+" / "+e._s(e.passwordMaxLength)+" ")])]),s("div",{staticClass:"form__checkPassword"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checkPassword,expression:"checkPassword"}],staticClass:"form__checkPassword__input",attrs:{id:"checkPassword",name:"checkPassword",type:"password",required:""},domProps:{value:e.checkPassword},on:{input:function(t){t.target.composing||(e.checkPassword=t.target.value)}}}),s("div",{class:["form__checkPassword__border",{error:e.checkPasswordTip.length>0}]}),s("label",{staticClass:"form__checkPassword__label",attrs:{for:"form__checkPassword__input"}},[e._v(" 密碼確認 ")]),s("span",{staticClass:"form__checkPassword__tip"},[e._v(e._s(e.checkPasswordTip))])]),"UserRegister"===e.$route.name?[s("button",{staticClass:"form__submit",attrs:{type:"submit"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isProcessing,expression:"!isProcessing"}]},[e._v("註冊")]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isProcessing,expression:"isProcessing"}],staticClass:"form__submit__spinner"})]),s("router-link",{staticClass:"form__cancel-link",attrs:{to:"/user/login"}},[e._v(" 取消 ")])]:s("div",{staticClass:"form__submit__wrapper"},[s("button",{staticClass:"form__submit form__submit--setting",attrs:{type:"submit"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isProcessing,expression:"!isProcessing"}]},[e._v("儲存")]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isProcessing,expression:"isProcessing"}],staticClass:"form__submit__spinner"})])])],2)},n=[],r=s("1da1");function i(e){if(Array.isArray(e))return e}s("a4d3"),s("e01a"),s("d3b7"),s("d28b"),s("3ca3"),s("ddb0");function o(e,t){var s=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=s){var a,n,r=[],i=!0,o=!1;try{for(s=s.call(e);!(i=(a=s.next()).done);i=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){o=!0,n=c}finally{try{i||null==s["return"]||s["return"]()}finally{if(o)throw n}}return r}}var c=s("06c5");function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){return i(e)||o(e,t)||Object(c["a"])(e,t)||l()}function p(e,t){var s="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=Object(c["a"])(e))||t&&e&&"number"===typeof e.length){s&&(e=s);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,o=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return i=e.done,e},e:function(e){o=!0,r=e},f:function(){try{i||null==s["return"]||s["return"]()}finally{if(o)throw r}}}}s("96cf"),s("b0c0"),s("ac1f"),s("1276"),s("159b"),s("caad"),s("2532");var m=s("4cce"),d=s("2708"),h={name:"AccountForm",mixins:[d["a"]],props:{page:{type:String,default:"signUp"},initAccount:{type:String,default:""},initName:{type:String,default:""},initEmail:{type:String,default:""}},data:function(){return{account:this.initAccount,name:this.initName,email:this.initEmail,password:"",checkPassword:"",accountMaxLength:50,nameMaxLength:50,passwordMinLength:4,passwordMaxLength:50,isProcessing:!1,regex:/^[a-zA-Z0-9_-]+$/,accountTip:"",nameTip:"",emailTip:"",passwordTip:"",checkPasswordTip:""}},computed:{accountLength:function(){return this.account.length},nameLength:function(){return this.name.length},passwordLength:function(){return this.password.length}},watch:{account:function(){this.account?this.account.length>this.accountMaxLength?this.accountTip="帳號上限 ".concat(this.accountMaxLength," 字"):this.regex.test(this.account)?this.accountTip="":this.accountTip="帳號只能為英文、數字與_ ":this.accountTip="請填寫帳號"},name:function(){this.name?this.name.length>this.nameMaxLength?this.nameTip="名稱上限 ".concat(this.nameMaxLength," 字"):this.nameTip="":this.nameTip="請填寫名稱"},email:function(){this.email?this.emailTip="":this.emailTip="請填寫Email"},password:function(){this.password?this.password.length>this.passwordMaxLength?this.passwordTip="密碼上限 ".concat(this.passwordMaxLength," 字"):this.password.length<this.passwordMinLength?this.passwordTip="密碼至少 ".concat(this.passwordMinLength," 個字"):this.passwordTip="":this.passwordTip="請填寫密碼",this.checkPassword.length>0&&(this.checkPasswordTip=this.password!==this.checkPassword?"密碼輸入不一致":"")},checkPassword:function(){this.checkPassword?this.password!==this.checkPassword?this.checkPasswordTip="密碼輸入不一致":this.checkPasswordTip="":this.checkPasswordTip="請填寫密碼確認"}},methods:{formValidation:function(){return!(this.accountTip.length>0||this.nameTip.length>0||this.emailTip.length>0||this.passwordTip.length>0||this.checkPasswordTip.length>0)||(this.ToastError({title:"請正確填寫所有資料"}),!1)},handleSubmit:function(e){if(this.formValidation()){this.accountTip="",this.nameTip="",this.emailTip="",this.passwordTip="",this.checkPasswordTip="",this.isProcessing=!0;var t,s=new FormData(e.target),a={},n=p(s.entries());try{for(n.s();!(t=n.n()).done;){var r=u(t.value,2),i=r[0],o=r[1];a[i]=o}}catch(c){n.e(c)}finally{n.f()}"signUp"===this.page?this.handleSignUpSubmit(a):"setting"===this.page&&this.handleSettingSubmit(a)}},handleSignUpSubmit:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){var a,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,t.isProcessing=!0,s.next=4,m["a"].signUp(e);case 4:if(a=s.sent,n=a.data,"success"===n.status){s.next=8;break}throw new Error(n.message);case 8:t.ToastSuccess({title:"帳號註冊成功！",description:n.message}),t.$router.push({name:"UserLogin"}),s.next=16;break;case 12:s.prev=12,s.t0=s["catch"](0),t.isProcessing=!1,s.t0.response?t.handleError(s.t0.response.data):(console.log(s.t0),t.ToastError({title:"帳號註冊失敗！",description:s.t0.message}));case 16:case"end":return s.stop()}}),s,null,[[0,12]])})))()},handleSettingSubmit:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){var a,n,r,i,o,c;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,t.isProcessing=!0,s.next=4,m["a"].setting({userId:t.$store.getters.getCurrentUser.id,requestData:e});case 4:if(a=s.sent,n=a.data,"success"===n.status){s.next=8;break}throw new Error(n.message);case 8:t.isProcessing=!1,r=n.user,i=r.account,o=r.name,c=r.email,t.$store.commit("setCurrentUser",{account:i,name:o,email:c}),t.ToastSuccess({title:"帳戶設定成功！",description:n.message}),s.next=18;break;case 14:s.prev=14,s.t0=s["catch"](0),t.isProcessing=!1,s.t0.response?t.handleError(s.t0.response.data):(console.log(s.t0),t.ToastError({title:"帳戶設定失敗！",description:s.t0.message}));case 18:case"end":return s.stop()}}),s,null,[[0,14]])})))()},handleError:function(e){var t=this,s="signUp"===this.page?"帳號註冊失敗！":"帳戶設定失敗！";if("UserSingnUpError"===e.errType||"PutUserFormatError"===e.errType){var a=e.message.split("|");a.forEach((function(e){e.includes("account cannot be blank")?t.accountTip+="請填寫帳號 ":e.includes("account should not exceed")?t.accountTip+="帳號上限 50 字 ":e.includes("account should only include")?t.accountTip+="帳號只能為英文、數字與_ ":e.includes("name cannot be blank")?t.nameTip+="請填寫名稱 ":e.includes("name should not exceed")?t.nameTip+="名稱上限 50 字 ":e.includes("email cannot be blank")?t.emailTip+="請填寫Email ":e.includes("Email must be a valid email")?t.emailTip+="請填寫正確的Email ":e.includes("password cannot be blank")?t.passwordTip+="請填寫密碼 ":e.includes("password should not exceed")?t.passwordTip+="密碼上限 50 字 ":e.includes("at least 4 characters")?t.passwordTip+="密碼至少 4 個字 ":e.includes("is not equal to checkPassword")&&(t.checkPasswordTip+="密碼輸入不一致 "),t.ToastError({title:s,description:e})}))}else{switch(e.errType){case"AccountExistsError":this.accountTip="帳號已被使用";break;case"NameExistsError":this.nameTip="名稱已被使用";break;case"EmailExistsError":this.emailTip="Email已被使用";break;default:break}this.ToastError({title:s,description:e.message})}}}},_=h,f=(s("33eb"),s("2877")),g=Object(f["a"])(_,a,n,!1,null,"aad6ff76",null);t["a"]=g.exports}}]);
//# sourceMappingURL=chunk-357f3bfe.915de849.js.map