(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ffb65e12"],{3435:function(s,e,t){"use strict";t("f801")},"5b4f":function(s,e,t){"use strict";t.r(e);var a=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",[s._m(0),t("LoginForm",{attrs:{title:s.title,path:s.path,role:"admin"}}),t("section",{staticClass:"section-actions"},[t("router-link",{staticClass:"section-actions__link",attrs:{to:"/user/login"}},[s._v(" 前台登入 ")])],1)],1)},i=[function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("div",{staticClass:"logo"},[a("img",{attrs:{src:t("e347"),alt:"logo"}})])}],r=t("61b1"),o={name:"AdminLogin",components:{LoginForm:r["a"]},data:function(){return{title:"後台登入",path:{name:"AdminAllTweets"}}}},n=o,l=(t("3435"),t("2877")),p=Object(l["a"])(n,a,i,!1,null,"60fd1bf0",null);e["default"]=p.exports},"61b1":function(s,e,t){"use strict";var a=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("form",{staticClass:"form",on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),s.handleSubmit.apply(null,arguments)}}},[t("div",{staticClass:"form__title"},[s._v(s._s(s.title))]),t("div",{staticClass:"form__email"},[t("input",{directives:[{name:"model",rawName:"v-model",value:s.email,expression:"email"}],staticClass:"form__email__input",attrs:{id:"email",name:"email",type:"email",required:""},domProps:{value:s.email},on:{input:function(e){e.target.composing||(s.email=e.target.value)}}}),t("div",{class:["form__email__border",{error:s.emailTip.length>0}]}),t("label",{staticClass:"form__email__label",attrs:{for:"form__email__input"}},[s._v(" Email ")]),t("span",{staticClass:"form__email__tip"},[s._v(s._s(s.emailTip))])]),t("div",{staticClass:"form__password"},[t("input",{directives:[{name:"model",rawName:"v-model",value:s.password,expression:"password"}],staticClass:"form__password__input",attrs:{id:"password",name:"password",type:"password",required:""},domProps:{value:s.password},on:{input:function(e){e.target.composing||(s.password=e.target.value)}}}),t("div",{class:["form__password__border",{error:s.passwordTip.length>0}]}),t("label",{staticClass:"form__password__label",attrs:{for:"form__password__input"}},[s._v(" 密碼 ")]),t("span",{staticClass:"form__password__tip"},[s._v(s._s(s.passwordTip))])]),t("button",{staticClass:"form__submit",attrs:{type:"submit"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!s.isProcessing,expression:"!isProcessing"}]},[s._v("登入")]),t("div",{directives:[{name:"show",rawName:"v-show",value:s.isProcessing,expression:"isProcessing"}],staticClass:"form__submit__spinner"})])])},i=[],r=t("1da1"),o=(t("ac1f"),t("1276"),t("159b"),t("caad"),t("2532"),t("96cf"),t("2fa3")),n={signIn:function(s){var e=s.email,t=s.password,a=s.role;return o["a"].post("/".concat(a,"/signin"),{email:e,password:t})}},l=t("2708"),p={name:"LoginForm",mixins:[l["a"]],props:{role:{type:String,default:"users"},title:{type:String,default:""},path:{type:Object,required:!0}},data:function(){return{isProcessing:!1,email:"",password:"",passwordMinLength:4,passwordMaxLength:50,emailTip:"",passwordTip:""}},watch:{email:function(){this.email?this.emailTip="":this.emailTip="請填寫Email"},password:function(){this.password?this.password.length>this.passwordMaxLength?this.passwordTip="密碼上限 ".concat(this.passwordMaxLength," 字"):this.password.length<this.passwordMinLength?this.passwordTip="密碼至少 ".concat(this.passwordMinLength," 個字"):this.passwordTip="":this.passwordTip="請填寫密碼"}},methods:{formValidation:function(){return!(this.emailTip.length>0||this.passwordTip.length>0)||(this.ToastError({title:"請正確填寫Email和密碼"}),!1)},handleSubmit:function(){var s=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,s.formValidation()){e.next=3;break}return e.abrupt("return");case 3:return s.emailTip="",s.passwordTip="",s.isProcessing=!0,e.next=8,n.signIn({email:s.email,password:s.password,role:s.role});case 8:if(t=e.sent,a=t.data,"success"===a.status){e.next=12;break}throw new Error(a.message);case 12:localStorage.setItem("token",a.token),s.$router.push(s.path),s.ToastSuccess({title:"登入成功！",description:a.message}),e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](0),s.isProcessing=!1,e.t0.response?s.handleError(e.t0.response.data):(console.log(e.t0),s.ToastError({title:"登入失敗！",description:e.t0.message}));case 21:case"end":return e.stop()}}),e,null,[[0,17]])})))()},handleError:function(s){var e=this;if("UserSingInFormatError"===s.errType){var t=s.message.split("|");t.forEach((function(s){s.includes("email cannot be blank")?e.emailTip+="請填寫Email ":s.includes("Email must be a valid email")?e.emailTip+="請填寫正確的Email ":s.includes("password cannot be blank")?e.passwordTip+="請填寫密碼 ":s.includes("password should not exceed")?e.passwordTip+="密碼上限 50 字 ":s.includes("at least 4 characters")&&(e.passwordTip+="密碼至少 4 個字 "),e.ToastError({title:"登入失敗！",description:s})}))}else{switch(s.errType){case"UserSingInError":case"UserSingInRoleError":this.emailTip="Email不存在";break;case"UserSingInPasswordError":this.passwordTip="密碼輸入錯誤";break;default:break}this.ToastError({title:"登入失敗！",description:s.message})}}}},c=p,m=(t("f900"),t("2877")),d=Object(m["a"])(c,a,i,!1,null,"01bf874a",null);e["a"]=d.exports},"735c":function(s,e,t){},f801:function(s,e,t){},f900:function(s,e,t){"use strict";t("735c")}}]);
//# sourceMappingURL=chunk-ffb65e12.9c30f174.js.map