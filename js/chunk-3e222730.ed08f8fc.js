(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e222730"],{2818:function(s,t,e){"use strict";e.r(t);var a=function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",[s._m(0),e("LoginForm",{attrs:{title:s.title,path:s.path}}),e("section",{staticClass:"section-actions"},[e("router-link",{staticClass:"section-actions__link",attrs:{to:"/user/register"}},[s._v(" 註冊 Alphitter ")]),e("span",{staticClass:"section-actions__dot"},[s._v("·")]),e("router-link",{staticClass:"section-actions__link",attrs:{to:"/admin/login"}},[s._v(" 後台登入 ")])],1)],1)},i=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"logo"},[a("img",{attrs:{src:e("e347"),alt:"logo"}})])}],r=e("61b1"),o={name:"UserLogin",components:{LoginForm:r["a"]},data:function(){return{title:"登入 Alphitter",path:{name:"User"}}}},n=o,l=(e("74e8"),e("2877")),p=Object(l["a"])(n,a,i,!1,null,"75723660",null);t["default"]=p.exports},"61b1":function(s,t,e){"use strict";var a=function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("form",{staticClass:"form",on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),s.handleSubmit.apply(null,arguments)}}},[e("div",{staticClass:"form__title"},[s._v(s._s(s.title))]),e("div",{staticClass:"form__email"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.email,expression:"email"}],staticClass:"form__email__input",attrs:{id:"email",name:"email",type:"email",required:""},domProps:{value:s.email},on:{input:function(t){t.target.composing||(s.email=t.target.value)}}}),e("div",{class:["form__email__border",{error:s.emailTip.length>0}]}),e("label",{staticClass:"form__email__label",attrs:{for:"form__email__input"}},[s._v(" Email ")]),e("span",{staticClass:"form__email__tip"},[s._v(s._s(s.emailTip))])]),e("div",{staticClass:"form__password"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.password,expression:"password"}],staticClass:"form__password__input",attrs:{id:"password",name:"password",type:"password",required:""},domProps:{value:s.password},on:{input:function(t){t.target.composing||(s.password=t.target.value)}}}),e("div",{class:["form__password__border",{error:s.passwordTip.length>0}]}),e("label",{staticClass:"form__password__label",attrs:{for:"form__password__input"}},[s._v(" 密碼 ")]),e("span",{staticClass:"form__password__tip"},[s._v(s._s(s.passwordTip))])]),e("button",{staticClass:"form__submit",attrs:{type:"submit"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:!s.isProcessing,expression:"!isProcessing"}]},[s._v("登入")]),e("div",{directives:[{name:"show",rawName:"v-show",value:s.isProcessing,expression:"isProcessing"}],staticClass:"form__submit__spinner"})])])},i=[],r=e("1da1"),o=(e("ac1f"),e("1276"),e("159b"),e("caad"),e("2532"),e("96cf"),e("2fa3")),n={signIn:function(s){var t=s.email,e=s.password,a=s.role;return o["a"].post("/".concat(a,"/signin"),{email:t,password:e})}},l=e("2708"),p={name:"LoginForm",mixins:[l["a"]],props:{role:{type:String,default:"users"},title:{type:String,default:""},path:{type:Object,required:!0}},data:function(){return{isProcessing:!1,email:"",password:"",passwordMinLength:4,passwordMaxLength:50,emailTip:"",passwordTip:""}},watch:{email:function(){this.email?this.emailTip="":this.emailTip="請填寫Email"},password:function(){this.password?this.password.length>this.passwordMaxLength?this.passwordTip="密碼上限 ".concat(this.passwordMaxLength," 字"):this.password.length<this.passwordMinLength?this.passwordTip="密碼至少 ".concat(this.passwordMinLength," 個字"):this.passwordTip="":this.passwordTip="請填寫密碼"}},methods:{formValidation:function(){return!(this.emailTip.length>0||this.passwordTip.length>0)||(this.ToastError({title:"請正確填寫Email和密碼"}),!1)},handleSubmit:function(){var s=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,s.formValidation()){t.next=3;break}return t.abrupt("return");case 3:return s.emailTip="",s.passwordTip="",s.isProcessing=!0,t.next=8,n.signIn({email:s.email,password:s.password,role:s.role});case 8:if(e=t.sent,a=e.data,"success"===a.status){t.next=12;break}throw new Error(a.message);case 12:localStorage.setItem("token",a.token),s.$router.push(s.path),s.ToastSuccess({title:"登入成功！",description:a.message}),t.next=21;break;case 17:t.prev=17,t.t0=t["catch"](0),s.isProcessing=!1,t.t0.response?s.handleError(t.t0.response.data):(console.log(t.t0),s.ToastError({title:"登入失敗！",description:t.t0.message}));case 21:case"end":return t.stop()}}),t,null,[[0,17]])})))()},handleError:function(s){var t=this;if("UserSingInFormatError"===s.errType){var e=s.message.split("|");e.forEach((function(s){s.includes("email cannot be blank")?t.emailTip+="請填寫Email ":s.includes("Email must be a valid email")?t.emailTip+="請填寫正確的Email ":s.includes("password cannot be blank")?t.passwordTip+="請填寫密碼 ":s.includes("password should not exceed")?t.passwordTip+="密碼上限 50 字 ":s.includes("at least 4 characters")&&(t.passwordTip+="密碼至少 4 個字 "),t.ToastError({title:"登入失敗！",description:s})}))}else{switch(s.errType){case"UserSingInError":case"UserSingInRoleError":this.emailTip="Email不存在";break;case"UserSingInPasswordError":this.passwordTip="密碼輸入錯誤";break;default:break}this.ToastError({title:"登入失敗！",description:s.message})}}}},c=p,m=(e("f900"),e("2877")),d=Object(m["a"])(c,a,i,!1,null,"01bf874a",null);t["a"]=d.exports},"735c":function(s,t,e){},"74e8":function(s,t,e){"use strict";e("87f8")},"87f8":function(s,t,e){},e347:function(s,t,e){s.exports=e.p+"img/logo.daa01464.svg"},f900:function(s,t,e){"use strict";e("735c")}}]);
//# sourceMappingURL=chunk-3e222730.ed08f8fc.js.map